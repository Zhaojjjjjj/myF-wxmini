<view class="container">
  <!-- åŠ¨æ€3DèƒŒæ™¯ -->
  <view class="background-animation">
    <view class="shape"></view>
    <view class="shape"></view>
    <view class="shape"></view>
  </view>

  <!-- é¡¶éƒ¨æŒ‰é’® -->
  <view class="header">
    <button class="refresh-btn" bindtap="refreshRoom">
      <text class="btn-text">åˆ·æ–°</text>
    </button>
    <button class="invite-btn" bindtap="showInviteModal">
      <text class="btn-text">é‚€è¯·</text>
    </button>
    <button class="exit-btn" bindtap="exitRoom">
      <text class="btn-text">é€€å‡º</text>
    </button>
  </view>

  <!-- æˆå‘˜åˆ—è¡¨ -->
  <view class="members-container">
    <view class="members-scroll">
      <view wx:for="{{members}}" wx:key="id" class="member-card" bindtap="onMemberTap" data-user-id="{{item.id}}" data-user-nickname="{{item.nickname}}" data-user-avatar="{{item.avatar_url}}">
        <image class="avatar" src="{{item.avatar_url}}" mode="aspectFill"></image>
        <text class="nickname">{{item.nickname}}</text>
        <text class="score">{{item.score}}</text>
      </view>
    </view>
  </view>

  <!-- æ—¥å¿—åŒºåŸŸ -->
  <view class="logs">
    <block wx:for="{{logs}}" wx:key="id">
      <view class="log-item">
        <text class="log-text">{{item.created_at}} {{item.from_user_nickname}}è½¬è´¦{{item.to_user_nickname}} {{item.amount}}</text>
      </view>
    </block>
  </view>

  <!-- é‚€è¯·å¼¹çª— -->
  <view class="modal" wx:if="{{showInviteModal}}">
    <view class="modal-content">
      <image class="qrcode" src="{{qrcodeUrl}}" mode="aspectFit"></image>
      <button class="share-btn" open-type="share">
        <text class="btn-icon">ğŸ“¤</text>
        <text class="btn-text">é‚€è¯·å¥½å‹</text>
      </button>
      <button class="close-btn" bindtap="hideInviteModal">
        <text class="btn-icon">âŒ</text>
        <text class="btn-text">å…³é—­</text>
      </button>
    </view>
  </view>

  <!-- è½¬åˆ†å¼¹çª— -->
  <view class="modal" wx:if="{{showTransferModal}}">
    <view class="modal-content">
      <input class="transfer-input" placeholder="è¾“å…¥è½¬è´¦é‡‘é¢(1-10000)" type="number" bindinput="onTransferAmountInput" />
      <button class="confirm-btn" bindtap="confirmTransfer">
        <text class="btn-icon">ğŸ’°</text>
        <text class="btn-text">ç¡®å®šè½¬è´¦</text>
      </button>
      <button class="close-btn" bindtap="hideTransferModal">
        <text class="btn-icon">âŒ</text>
        <text class="btn-text">å–æ¶ˆ</text>
      </button>
    </view>
  </view>

  <!-- ä¿®æ”¹èµ„æ–™å¼¹çª— -->
  <view class="modal" wx:if="{{showProfileModal}}">
    <view class="modal-content">
      <!-- å¤´åƒé¢„è§ˆå’Œä¸Šä¼ åŒºåŸŸ -->
      <view class="avatar-upload-section">
        <image class="avatar-preview" src="{{currentUserAvatar}}" mode="aspectFill" bindtap="chooseAvatar"></image>
        <button class="change-avatar-btn" bindtap="chooseAvatar">
          <text class="btn-icon">ğŸ“·</text>
          <text class="btn-text">æ›´æ¢å¤´åƒ</text>
        </button>
      </view>

      <!-- æ˜µç§°è¾“å…¥ -->
      <input class="profile-input" placeholder="è¾“å…¥æ˜µç§°" value="{{newNickname}}" bindinput="onNicknameInput" />

      <button class="confirm-btn" bindtap="confirmUpdateProfile">
        <text class="btn-icon">âœ…</text>
        <text class="btn-text">ä¿å­˜ä¿®æ”¹</text>
      </button>
      <button class="close-btn" bindtap="hideProfileModal">
        <text class="btn-icon">âŒ</text>
        <text class="btn-text">å–æ¶ˆ</text>
      </button>
    </view>
  </view>
</view>
